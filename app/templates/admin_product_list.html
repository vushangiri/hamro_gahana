{% extends "base.html" %}
{% block content %}

<div class="mb-3">
  <h2 class="mb-0">{{ store.store_name | capitalize }}</h2>
  <p class="text-muted mb-1">{{ store.store_address }}</p>
  <a href="https://maps.google.com/?q={{store.latitude}},{{store.longitude}}" target="_blank" class="btn btn-sm btn-light-2">
    <i class="bi bi-geo-alt"></i> View on Map
  </a>
</div>

{% if products %}
<table class="table table-bordered table-striped">
  <thead>
    <tr>
      <th>Image</th>
      <th>Name</th>
      <th>Status</th>
      <th class="text-end">Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for product in products %}
    <tr class="align-middle">
      <td style="width:70px;">
        {% if product.display_picture %}
        <img src="{{ url_for('static', filename='uploads/products/' ~ product.display_picture) }}" class="img-fluid rounded" style="width:60px; height:60px; object-fit:cover;">
        {% endif %}
      </td>
      <td>
        <a href="{{ url_for('user.product_detail', product_id=product.id) }}">
          {{ product.name | capitalize }}
        </a>
      </td>
      <td>
        <span class="badge {% if product.status == 'published' %}bg-success{% else %}bg-secondary{% endif %}">
          {{ product.status }}
        </span>
      </td>
      <td class="text-end">
        <form method="post" action="{{ url_for('admin.change_status', id=product.id) }}" class="d-inline-flex">
          <select name="status" class="form-select form-select-sm me-2">
            <option value="published" {% if product.status == 'published' %}selected{% endif %}>Published</option>
            <option value="hold" {% if product.status == 'hold' %}selected{% endif %}>Hold</option>
          </select>
          <button type="submit" class="btn btn-sm btn-primary">Update</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p class="text-muted">No products found for this store.</p>
{% endif %}

<a href="{{ url_for('admin.all_stores') }}" class="btn btn-outline-secondary mt-3">
  &laquo; Back to Stores
</a>

{% endblock %}
